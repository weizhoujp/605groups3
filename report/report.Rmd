---
title: "Analysis for Win Rate of Rainbowsix"
author: "Yujie Zhang, Pengfei He, Zifeng Wei, Zhoujingpeng Wei"
date: "2019-12-9"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Introduction
Rainbow Six Siege is the eighth installment released in December of 2015. The game is a multiplayer first-person shooter, and whilst it does have a co-op and single-player mode these are not the main focus of the title. The multiplayer consists of a 5 v 5 game mode with multiple rounds. Five of the players play on the defense, having to protect an objective from the other five players on attack, the teams then switch sides until the game is won. 

We collected the S5 ranked data from Kaggle. The dataset has 31 variables such as operator, numberkills and weapontype. We'd like to choose some variables and use a generalized linear model to predict the win rate. And use CHTC and statistical tools to analyze which is the most influential factor.

## Body
### Data Description
Our dataset contains 22 CSV files and each file has a similar structure. Each file contains 31 columns including platform, mapname, operator, weapontype, etc. Each row is a record of a player in a game. In one record, haswon shows whether this player wins the match thus we set it as the response in our model and other columns are potential predictors. The table below shows the details of some columns(due to the limitation of space).

category|platform|gamemode|mapname|skillrank|role|haswon|operator|primaryweapon|primaryweapontype|secondaryweapon|secondaryweapontype
------------|--------|--------|-------|---------|----|------|--------|-------------|-----------------|---------------|--------------------
data type|categorical|categorical|categorical|categorical|categorical|numeric|categorical|categorical|categorical|categorical|categorical
number of levels|3|3|16|7|2|0,1|35|46|6|16|3


### Data Splitting and Cleaning

According to the background knowledge, the player's probability of winning differs between different platforms and maps so we decided to use these two variables as blocks and split the data sets by blocks. We will run a model within each block and see the difference within and between each block.

There are 3 platforms and 16 different plots. After splitting the data sets we finally get 48 CSV files and there are no missing values so there's no need to do data cleaning.

### Model Constructing

Since haswon is a binomial outcome so we decide to fit a generalized linear model and the formula is 
$$
logit(\pi) = X\beta
$$
where $\pi$ is the probability of win and X are the predictors. For predictors, we mainly choose those can be controlled by players, such as game mode, operators, primary weapon types, secondary weapon types and role(attacker or defender). We write R code to fit the model. 

Since this game does not allow cross-platform matches, it is not reasonable to merge all data and build a general model. Also, we are interested in performance in different maps, so we decide to fit a model for each combination of maps and platforms. To be more efficient, we use CHTC to run 48 parallel jobs to do the model fitting. For each job, one dataset is submitted and a model is fitted on this dataset and the summary table is written into a new CSV file. Thus, our final output is 48 CSV files containing a summary for each model.

### Model Summary

Pick PS4 platform and map Bank as an example, the summary of our model looks like this:

```{r include=FALSE}
setwd("D:/project")
PS4_BANK=read.csv("PS4_BANK.csv",row.names = c("(Intercept)","gamemode HOSTAGE","gamemode SECURE_AREA","operator BOPE-CAVEIRA","operator G.E.O.-JACKAL" ,              "operator G.E.O.-MIRA"                
                                             ,"operator GIGN-DOC"                   , "operator GIGN-MONTAGNE"        ,       "operator GIGN-RESERVE"               
                                             ,"operator GIGN-ROOK"                  , "operator GIGN-TWITCH"           ,      "operator GSG9-BANDIT"                
                                             ,"operator GSG9-BLITZ"                 , "operator GSG9-IQ"                ,     "operator GSG9-JAGER"                 
                                             ,"operator GSG9-RESERVE"               , "operator JTF2-BUCK"               ,    "operator JTF2-FROST"                  
                                             ,"operator NAVYSEAL-BLACKBEARD"        , "operator NAVYSEAL-VALKYRIE"        ,   "operator SAS-MUTE"                   
                                             ,"operator SAS-RESERVE"                , "operator SAS-SLEDGE"                ,  "operator SAS-SMOKE"                  
                                             ,"operator SAS-THATCHER"               , "operator SAT-ECHO"                   , "operator SAT-HIBANA"                 
                                             ,"operator SPETSNAZ-FUZE"              , "operator SPETSNAZ-GLAZ"              , "operator SPETSNAZ-KAPKAN"            
                                             ,"operator SPETSNAZ-RESERVE"           , "operator SPETSNAZ-TACHANKA"          , "operator SWAT-ASH"   ,"operator SWAT-CASTLE"                , "operator SWAT-PULSE"                 , "operator SWAT-RESERVE"               
                                             ,"operator SWAT-THERMITE"   , "skillrank Copper"                    , "skillrank Diamond"                   
                                             ,"skillrank Gold"    ,  "skillrank Platinum"                  , "skillrank Silver"                    
                                             ,"skillrank Unranked"                ,   "role Defender"                       , "primaryweapontype Light_Machine_Guns"
                                             ,"primaryweapontype Marksman_Rifles",    "primaryweapontype Shield"             ,"primaryweapontype Shotguns"          
                                             ,"primaryweapontype Submachine_Guns"    ,"secondaryweapontype Shotguns"        , "secondaryweapontype Submachine_Guns"))

```


Predictor                     |Estimate   |P-value  
------------------------------|-----------|---------
(Intercept)                   |-0.084078    |2e-16
gamemode HOSTAGE              | 0.026835    |5.57e-09 
gamemode SECURE_AREA          | 0.007719    |0.005831
operator BOPE-CAVEIRA         |0.228275   |2e-16
operator G.E.O.-JACKAL        |0.051821   |0.000121
operator G.E.O.-MIRA          |0.196633   |7.58e-16
operator GIGN-DOC             |0.191725   |2e-16
operator GIGN-MONTAGNE        |0.013030   |0.686289  
operator GIGN-RESERVE        |-0.051270   |0.105298    
operator GIGN-ROOK            |0.332158   |2e-16
operator GIGN-TWITCH          |0.054363   |1.38e-07
operator GSG9-BANDIT          |0.218819   |2e-16
doperator GSG9-BLITZ          | 0.034483   |0.312945    
operator GSG9-IQ              |0.034108   |0.006452
operator GSG9-JAGER           |0.204236   |2e-16
operator GSG9-RESERVE         |0.003908   |0.853507    
operator JTF2-BUCK           |-0.007526   |0.540756    
daoperator JTF2-FROST         |  0.322495  | 2e-16
operator NAVYSEAL-BLACKBEARD  |0.005582   |0.661821    
operator NAVYSEAL-VALKYRIE    |0.236373   |2e-16
operator SAS-MUTE             |0.213171   |2e-16
operator SAS-RESERVE         |-0.068705   |0.003886
operator SAS-SLEDGE          |-0.004482   |0.748854    
operator SAS-SMOKE            |0.155836   |1.62e-10
operator SAS-THATCHER        |-0.030343   |0.013953
operator SAT-ECHO             |0.194982   |4.64e-14
operator SAT-HIBANA          |-0.012299   |0.386302    
operator SPETSNAZ-FUZE        |0.038822   |0.000413
operator SPETSNAZ-GLAZ        |0.066453   |4.96e-05
operator SPETSNAZ-KAPKAN      |0.231236   |2e-16
operator SPETSNAZ-RESERVE    |-0.033865   |0.297013    
operator SPETSNAZ-TACHANKA    |0.088715   |0.001710
operator SWAT-ASH             |0.026632   |0.007582
operator SWAT-CASTLE          |0.176725   |1.79e-14
operator SWAT-PULSE           |0.176232   |4.62e-15
operator SWAT-RESERVE         |0.005428   |0.848121    
operator SWAT-THERMITE        |0.001190   |0.911291    
skillrank Copper              |-0.032700   |2.52e-13
skillrank Diamond              |0.267596   |2e-16
skillrank Gold                 |0.035514   |2e-16
skillrank Platinum             |0.053474   |2e-16
skillrank Silver               |0.014006   |0.000771
skillrank Unranked            |-0.180791   |2e-16
role Defender                 |0.002448   |0.901448    
primaryweapontype Light_Machine_Guns  |-0.054157   |6.25e-05
primaryweapontype Marksman_Rifles     |-0.046337   |0.000127
primaryweapontype Shield              |-0.071869   |0.016470
primaryweapontype Shotguns            |-0.066057   |1.10e-10
primaryweapontype Submachine_Guns     |-0.026038   |0.010458
secondaryweapontype Shotguns           | -0.008759  | 0.414688    
secondaryweapontype Submachine_Guns     | 0.040700   |0.000109

From the summary, we could find out most coefficients are statistically significant which means they do influence the performance of players. The estimates indicate the difference between each variable. More detailed conclusions are shown in the next section.

## Conclusion

